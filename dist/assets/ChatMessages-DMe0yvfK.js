import{x as me,e as T,N as Y,D as E,c as k,z as A,y as L,a as h,I as ae,b as j,A as ye,r as R,g as oe,p as J,O as Le,k as fe,t as z,f as Ie,m as Te,n as Pe,h as ge,s as H,o as ie,P as Oe,Q as $,R as Ye,w as U,S as Ue,j as Me,U as We,l as ne,q as qe,V as Xe,i as Ze,W as Ge,X as je,u as Je,d as Qe,Y as Ke,Z as et,_ as tt,v as Z,T as nt,$ as G,a0 as at,a1 as lt,a2 as ot,a3 as it,G as st,F as be,E as rt,a4 as ut,H as ct,J as ue,a5 as dt}from"./index-BN2Uu5Tc.js";import{p as vt,i as mt,u as Be,g as ft,s as gt,d as ht}from"./ssrBoot-Bxby9pek.js";import{V as yt,a as ce,u as bt,m as wt,c as St,d as kt,e as de,b as Ct,t as Vt}from"./VRow-D-1N7VL_.js";import{_ as Ne,o as le,k as xt,c as Ee,b as ve,p as _t,d as De,e as pe,u as Q,m as he,f as Re,g as Fe,q as It,a as ze,h as Ae,l as Tt,n as Pt,r as Mt,V as Bt,i as Nt,I as we}from"./_plugin-vue_export-helper-B5FP-4nx.js";import{c as Et}from"./createSimpleFunctional-JI7iFSb2.js";import{u as $e,m as He,U as Dt,s as pt}from"./imClient-BeeRUWdN.js";import{u as Rt,V as Se,a as ke,f as Ft,m as zt,b as At,c as $t,d as Ht}from"./forwardRefs-Bh1jjzdV.js";const Ce=Et("v-spacer","div","VSpacer"),Lt={class:"message"},Ot=["src","alt"],Yt={key:0,class:"ordinary-message"},Ut=["src"],Wt=["src","alt"],qt=me({__name:"Message",props:{message:{},myself:{type:Boolean}},setup(e){const i=T(()=>typeof e.message=="string"?vt(e.message):e.message);return(a,m)=>(E(),Y("div",Lt,[k(yt,null,{default:A(()=>[a.myself?(E(),L(ce,{key:0,cols:"2",class:"avatars"},{default:A(()=>[h("img",{src:i.value.pic,alt:i.value.nickName},null,8,Ot)]),_:1})):(E(),L(Ce,{key:1})),k(ce,{cols:"8"},{default:A(()=>[a.myself?(E(),Y("h6",{key:0,class:j({"text-end":!a.myself})},ye(i.value.nickName),3)):ae("",!0),h("div",{class:j(["message-content",{"my-message-content":!a.myself}])},[i.value.type===1e3?(E(),Y("span",Yt,ye(i.value.content),1)):i.value.type===1001?(E(),Y("img",{key:1,src:i.value.content},null,8,Ut)):ae("",!0)],2)]),_:1}),a.myself?(E(),L(Ce,{key:2})):(E(),L(ce,{key:3,cols:"2",class:"avatars"},{default:A(()=>[h("img",{src:i.value.pic,alt:i.value.nickName},null,8,Wt)]),_:1}))]),_:1})]))}}),Xt=Ne(qt,[["__scopeId","data-v-d7d1ca49"]]),Zt=["capture"],Gt=me({__name:"OtherMessageInput",emits:["rulesSend"],setup(e,{emit:i}){const a=i,m=R(null),t=R(void 0),s=()=>{var u;t.value="environment",(u=m.value)==null||u.click()},o=()=>{var u;t.value=void 0,(u=m.value)==null||u.click()},y=async u=>{const c=u.target.files;if(c&&c.length>0){const v=await mt(c[0]);v!==null&&f({message:v,messageType:1001})}},f=u=>{a("rulesSend",u)};return(u,g)=>(E(),L(xt,{class:"d-flex"},{default:A(()=>[h("input",{ref_key:"file",ref:m,type:"file",class:"d-none",accept:"image/*",capture:t.value,onChange:y},null,40,Zt),h("div",{class:"bottom-btn other-btn mr-4",onClick:o},[k(le,{icon:"mdi-image-outline",size:"x-large"})]),h("div",{class:"bottom-btn other-btn mr-4",onClick:s},[k(le,{icon:"mdi-camera-outline",size:"x-large"})])]),_:1}))}}),jt=Ne(Gt,[["__scopeId","data-v-f051bd29"]]),Jt=J({baseColor:String,bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:e=>!e||["horizontal","shift"].includes(e)},height:{type:[Number,String],default:56},active:{type:Boolean,default:!0},...Ae(),...ze(),...It(),...Fe(),...Re(),...He({name:"bottom-navigation"}),...he({tag:"header"}),...wt({selectedClass:"v-btn--selected"}),...Te()},"VBottomNavigation"),Qt=oe()({name:"VBottomNavigation",props:Jt(),emits:{"update:active":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{slots:a}=i;const{themeClasses:m}=Le(),{borderClasses:t}=Ee(e),{backgroundColorClasses:s,backgroundColorStyles:o}=ve(()=>e.bgColor),{densityClasses:y}=_t(e),{elevationClasses:f}=De(e),{roundedClasses:u}=pe(e),{ssrBootStyles:g}=Be(),c=T(()=>Number(e.height)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0)),v=fe(e,"active",e.active),{layoutItemStyles:b}=$e({id:e.name,order:T(()=>parseInt(e.order,10)),position:z(()=>"bottom"),layoutSize:z(()=>v.value?c.value:0),elementSize:c,active:v,absolute:z(()=>e.absolute)});return bt(e,St),Ie({VBtn:{baseColor:z(()=>e.baseColor),color:z(()=>e.color),density:z(()=>e.density),stacked:z(()=>e.mode!=="horizontal"),variant:"text"}},{scoped:!0}),Q(()=>k(e.tag,{class:j(["v-bottom-navigation",{"v-bottom-navigation--active":v.value,"v-bottom-navigation--grow":e.grow,"v-bottom-navigation--shift":e.mode==="shift"},m.value,s.value,t.value,y.value,f.value,u.value,e.class]),style:Pe([o.value,b.value,{height:ge(c.value)},g.value,e.style])},{default:()=>[a.default&&h("div",{class:"v-bottom-navigation__content"},[a.default()])]})),{}}}),Kt=J({color:String,direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},side:{type:String,default:"end",validator:e=>["start","end","both"].includes(e)},mode:{type:String,default:"intersect",validator:e=>["intersect","manual"].includes(e)},margin:[Number,String],loadMoreText:{type:String,default:"$vuetify.infiniteScroll.loadMore"},emptyText:{type:String,default:"$vuetify.infiniteScroll.empty"},...Pt(),...he()},"VInfiniteScroll"),Ve=Ye({name:"VInfiniteScrollIntersect",props:{side:{type:String,required:!0},rootMargin:String},emits:{intersect:(e,i)=>!0},setup(e,i){let{emit:a}=i;const{intersectionRef:m,isIntersecting:t}=kt();return U(t,async s=>{a("intersect",e.side,s)}),Q(()=>h("div",{class:"v-infinite-scroll-intersect",style:{"--v-infinite-margin-size":e.rootMargin},ref:m},[Ue("Â ")])),{}}}),en=oe()({name:"VInfiniteScroll",props:Kt(),emits:{load:e=>!0},setup(e,i){let{slots:a,emit:m}=i;const t=R(),s=H("ok"),o=H("ok"),y=T(()=>ge(e.margin)),f=H(!1);function u(n){if(!t.value)return;const l=e.direction==="vertical"?"scrollTop":"scrollLeft";t.value[l]=n}function g(){if(!t.value)return 0;const n=e.direction==="vertical"?"scrollTop":"scrollLeft";return t.value[n]}function c(){if(!t.value)return 0;const n=e.direction==="vertical"?"scrollHeight":"scrollWidth";return t.value[n]}function v(){if(!t.value)return 0;const n=e.direction==="vertical"?"clientHeight":"clientWidth";return t.value[n]}ie(()=>{t.value&&(e.side==="start"?u(c()):e.side==="both"&&u(c()/2-v()/2))});function b(n,l){n==="start"?s.value=l:n==="end"?o.value=l:n==="both"&&(s.value=l,o.value=l)}function V(n){return n==="start"?s.value:o.value}let S=0;function D(n,l){f.value=l,f.value&&P(n)}function P(n){if(e.mode!=="manual"&&!f.value)return;const l=V(n);if(!t.value||["empty","loading"].includes(l))return;S=c(),b(n,"loading");function d(r){b(n,r),$(()=>{r==="empty"||r==="error"||(r==="ok"&&n==="start"&&u(c()-S+g()),e.mode!=="manual"&&$(()=>{window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{P(n)})})})}))})}m("load",{side:n,done:d})}const{t:x}=Oe();function w(n,l){var C,I,p,N,F;if(e.side!==n&&e.side!=="both")return;const d=()=>P(n),r={side:n,props:{onClick:d,color:e.color}};return l==="error"?(C=a.error)==null?void 0:C.call(a,r):l==="empty"?((I=a.empty)==null?void 0:I.call(a,r))??h("div",null,[x(e.emptyText)]):e.mode==="manual"?l==="loading"?((p=a.loading)==null?void 0:p.call(a,r))??k(de,{indeterminate:!0,color:e.color},null):((N=a["load-more"])==null?void 0:N.call(a,r))??k(Ct,{variant:"outlined",color:e.color,onClick:d},{default:()=>[x(e.loadMoreText)]}):((F=a.loading)==null?void 0:F.call(a,r))??k(de,{indeterminate:!0,color:e.color},null)}const{dimensionStyles:_}=Tt(e);Q(()=>{const n=e.tag,l=e.side==="start"||e.side==="both",d=e.side==="end"||e.side==="both",r=e.mode==="intersect";return k(n,{ref:t,class:j(["v-infinite-scroll",`v-infinite-scroll--${e.direction}`,{"v-infinite-scroll--start":l,"v-infinite-scroll--end":d}]),style:Pe(_.value)},{default:()=>{var C;return[h("div",{class:"v-infinite-scroll__side"},[w("start",s.value)]),l&&r&&k(Ve,{key:"start",side:"start",onIntersect:D,rootMargin:y.value},null),(C=a.default)==null?void 0:C.call(a),d&&r&&k(Ve,{key:"end",side:"end",onIntersect:D,rootMargin:y.value},null),h("div",{class:"v-infinite-scroll__side"},[w("end",o.value)])]}})});function B(n){const l=n??e.side;b(l,"ok"),$(()=>{u(c()-S+g()),e.mode!=="manual"&&$(()=>{window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{l==="both"?(P("start"),P("end")):P(l)})})})})})}return{reset:B}}});function tn(e){let{rootEl:i,isSticky:a,layoutItemStyles:m}=e;const t=H(!1),s=H(0),o=T(()=>{const u=typeof t.value=="boolean"?"top":t.value;return[a.value?{top:"auto",bottom:"auto",height:void 0}:void 0,t.value?{[u]:ge(s.value)}:{top:m.value.top}]});ie(()=>{U(a,u=>{u?window.addEventListener("scroll",f,{passive:!0}):window.removeEventListener("scroll",f)},{immediate:!0})}),Me(()=>{window.removeEventListener("scroll",f)});let y=0;function f(){const u=y>window.scrollY?"up":"down",g=i.value.getBoundingClientRect(),c=parseFloat(m.value.top??0),v=window.scrollY-Math.max(0,s.value-c),b=g.height+Math.max(s.value,c)-window.scrollY-window.innerHeight,V=parseFloat(getComputedStyle(i.value).getPropertyValue("--v-body-scroll-y"))||0;g.height<window.innerHeight-c?(t.value="top",s.value=c):u==="up"&&t.value==="bottom"||u==="down"&&t.value==="top"?(s.value=window.scrollY+g.top-V,t.value=!0):u==="down"&&b<=0?(s.value=0,t.value="bottom"):u==="up"&&v<=0&&(V?t.value!=="top"&&(s.value=-v+V+c,t.value="top"):(s.value=g.top+v,t.value="top")),y=window.scrollY}return{isStuck:t,stickyStyles:o}}const nn=100,an=20;function xe(e){return(e<0?-1:1)*Math.sqrt(Math.abs(e))*1.41421356237}function _e(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let i=0;for(let a=e.length-1;a>0;a--){if(e[a].t===e[a-1].t)continue;const m=xe(i),t=(e[a].d-e[a-1].d)/(e[a].t-e[a-1].t);i+=(t-m)*Math.abs(t),a===e.length-1&&(i*=.5)}return xe(i)*1e3}function ln(){const e={};function i(t){Array.from(t.changedTouches).forEach(s=>{(e[s.identifier]??(e[s.identifier]=new We(an))).push([t.timeStamp,s])})}function a(t){Array.from(t.changedTouches).forEach(s=>{delete e[s.identifier]})}function m(t){var u;const s=(u=e[t])==null?void 0:u.values().reverse();if(!s)throw new Error(`No samples for touch id ${t}`);const o=s[0],y=[],f=[];for(const g of s){if(o[0]-g[0]>nn)break;y.push({t:g[0],d:g[1].clientX}),f.push({t:g[0],d:g[1].clientY})}return{x:_e(y),y:_e(f),get direction(){const{x:g,y:c}=this,[v,b]=[Math.abs(g),Math.abs(c)];return v>b&&g>=0?"right":v>b&&g<=0?"left":b>v&&c>=0?"down":b>v&&c<=0?"up":on()}}}return{addMovement:i,endTouch:a,getVelocity:m}}function on(){throw new Error}function sn(e){let{el:i,isActive:a,isTemporary:m,width:t,touchless:s,position:o}=e;ie(()=>{window.addEventListener("touchstart",x,{passive:!0}),window.addEventListener("touchmove",w,{passive:!1}),window.addEventListener("touchend",_,{passive:!0})}),Me(()=>{window.removeEventListener("touchstart",x),window.removeEventListener("touchmove",w),window.removeEventListener("touchend",_)});const y=T(()=>["left","right"].includes(o.value)),{addMovement:f,endTouch:u,getVelocity:g}=ln();let c=!1;const v=H(!1),b=H(0),V=H(0);let S;function D(n,l){return(o.value==="left"?n:o.value==="right"?document.documentElement.clientWidth-n:o.value==="top"?n:o.value==="bottom"?document.documentElement.clientHeight-n:O())-(l?t.value:0)}function P(n){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const d=o.value==="left"?(n-V.value)/t.value:o.value==="right"?(document.documentElement.clientWidth-n-V.value)/t.value:o.value==="top"?(n-V.value)/t.value:o.value==="bottom"?(document.documentElement.clientHeight-n-V.value)/t.value:O();return l?Ze(d):d}function x(n){if(s.value)return;const l=n.changedTouches[0].clientX,d=n.changedTouches[0].clientY,r=25,C=o.value==="left"?l<r:o.value==="right"?l>document.documentElement.clientWidth-r:o.value==="top"?d<r:o.value==="bottom"?d>document.documentElement.clientHeight-r:O(),I=a.value&&(o.value==="left"?l<t.value:o.value==="right"?l>document.documentElement.clientWidth-t.value:o.value==="top"?d<t.value:o.value==="bottom"?d>document.documentElement.clientHeight-t.value:O());(C||I||a.value&&m.value)&&(S=[l,d],V.value=D(y.value?l:d,a.value),b.value=P(y.value?l:d),c=V.value>-20&&V.value<80,u(n),f(n))}function w(n){const l=n.changedTouches[0].clientX,d=n.changedTouches[0].clientY;if(c){if(!n.cancelable){c=!1;return}const C=Math.abs(l-S[0]),I=Math.abs(d-S[1]);(y.value?C>I&&C>3:I>C&&I>3)?(v.value=!0,c=!1):(y.value?I:C)>3&&(c=!1)}if(!v.value)return;n.preventDefault(),f(n);const r=P(y.value?l:d,!1);b.value=Math.max(0,Math.min(1,r)),r>1?V.value=D(y.value?l:d,!0):r<0&&(V.value=D(y.value?l:d,!1))}function _(n){if(c=!1,!v.value)return;f(n),v.value=!1;const l=g(n.changedTouches[0].identifier),d=Math.abs(l.x),r=Math.abs(l.y);(y.value?d>r&&d>400:r>d&&r>3)?a.value=l.direction===({left:"right",right:"left",top:"down",bottom:"up"}[o.value]||O()):a.value=b.value>.5}const B=T(()=>v.value?{transform:o.value==="left"?`translateX(calc(-100% + ${b.value*t.value}px))`:o.value==="right"?`translateX(calc(100% - ${b.value*t.value}px))`:o.value==="top"?`translateY(calc(-100% + ${b.value*t.value}px))`:o.value==="bottom"?`translateY(calc(100% - ${b.value*t.value}px))`:O(),transition:"none"}:void 0);return ne(v,()=>{var d,r;const n=((d=i.value)==null?void 0:d.style.transform)??null,l=((r=i.value)==null?void 0:r.style.transition)??null;qe(()=>{var C,I,p,N;(I=i.value)==null||I.style.setProperty("transform",((C=B.value)==null?void 0:C.transform)||"none"),(N=i.value)==null||N.style.setProperty("transition",((p=B.value)==null?void 0:p.transition)||null)}),Xe(()=>{var C,I;(C=i.value)==null||C.style.setProperty("transform",n),(I=i.value)==null||I.style.setProperty("transition",l)})}),{isDragging:v,dragProgress:b,dragStyles:B}}function O(){throw new Error}const rn=J({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function un(e,i){let a=()=>{};function m(o){a==null||a();const y=Number(o?e.openDelay:e.closeDelay);return new Promise(f=>{a=Ge(y,()=>{i==null||i(o),f(o)})})}function t(){return m(!0)}function s(){return m(!1)}return{clearDelay:a,runOpenDelay:t,runCloseDelay:s}}function cn(){const i=je("useScopeId").vnode.scopeId;return{scopeId:i?{[i]:""}:void 0}}const dn=["start","end","left","right","top","bottom"],vn=J({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,persistent:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>dn.includes(e)},sticky:Boolean,...Ae(),...ze(),...rn(),...tt({mobile:null}),...Fe(),...He(),...Re(),...he({tag:"nav"}),...Te()},"VNavigationDrawer"),mn=oe()({name:"VNavigationDrawer",props:vn(),emits:{"update:modelValue":e=>!0,"update:rail":e=>!0},setup(e,i){let{attrs:a,emit:m,slots:t}=i;const{isRtl:s}=Je(),{themeClasses:o}=Qe(e),{borderClasses:y}=Ee(e),{backgroundColorClasses:f,backgroundColorStyles:u}=ve(()=>e.color),{elevationClasses:g}=De(e),{displayClasses:c,mobile:v}=Ke(e),{roundedClasses:b}=pe(e),V=Mt(),S=fe(e,"modelValue",null,M=>!!M),{ssrBootStyles:D}=Be(),{scopeId:P}=cn(),x=R(),w=H(!1),{runOpenDelay:_,runCloseDelay:B}=un(e,M=>{w.value=M}),n=T(()=>e.rail&&e.expandOnHover&&w.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),l=T(()=>Vt(e.location,s.value)),d=z(()=>e.persistent),r=T(()=>!e.permanent&&(v.value||e.temporary)),C=T(()=>e.sticky&&!r.value&&l.value!=="bottom");ne(()=>e.expandOnHover&&e.rail!=null,()=>{U(w,M=>m("update:rail",!M))}),ne(()=>!e.disableResizeWatcher,()=>{U(r,M=>!e.permanent&&$(()=>S.value=!M))}),ne(()=>!e.disableRouteWatcher&&!!V,()=>{U(V.currentRoute,()=>r.value&&(S.value=!1))}),U(()=>e.permanent,M=>{M&&(S.value=!0)}),e.modelValue==null&&!r.value&&(S.value=e.permanent||!v.value);const{isDragging:I,dragProgress:p}=sn({el:x,isActive:S,isTemporary:r,width:n,touchless:z(()=>e.touchless),position:l}),N=T(()=>{const M=r.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):n.value;return I.value?M*p.value:M}),{layoutItemStyles:F,layoutItemScrimStyles:K}=$e({id:e.name,order:T(()=>parseInt(e.order,10)),position:l,layoutSize:N,elementSize:n,active:et(S),disableTransitions:z(()=>I.value),absolute:T(()=>e.absolute||C.value&&typeof W.value!="string")}),{isStuck:W,stickyStyles:se}=tn({rootEl:x,isSticky:C,layoutItemStyles:F}),ee=ve(()=>typeof e.scrim=="string"?e.scrim:null),re=T(()=>({...I.value?{opacity:p.value*.2,transition:"none"}:void 0,...K.value}));return Ie({VList:{bgColor:"transparent"}}),Q(()=>{const M=t.image||e.image;return h(G,null,[k(e.tag,Z({ref:x,onMouseenter:_,onMouseleave:B,class:["v-navigation-drawer",`v-navigation-drawer--${l.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":w.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":r.value,"v-navigation-drawer--persistent":d.value,"v-navigation-drawer--active":S.value,"v-navigation-drawer--sticky":C.value},o.value,f.value,y.value,c.value,g.value,b.value,e.class],style:[u.value,F.value,D.value,se.value,e.style]},P,a),{default:()=>{var q,te,X;return[M&&h("div",{key:"image",class:"v-navigation-drawer__img"},[t.image?k(Nt,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{alt:"",cover:!0,height:"inherit",src:e.image}}},t.image):k(Bt,{key:"image-img",alt:"",cover:!0,height:"inherit",src:e.image},null)]),t.prepend&&h("div",{class:"v-navigation-drawer__prepend"},[(q=t.prepend)==null?void 0:q.call(t)]),h("div",{class:"v-navigation-drawer__content"},[(te=t.default)==null?void 0:te.call(t)]),t.append&&h("div",{class:"v-navigation-drawer__append"},[(X=t.append)==null?void 0:X.call(t)])]}}),k(nt,{name:"fade-transition"},{default:()=>[r.value&&(I.value||S.value)&&!!e.scrim&&h("div",Z({class:["v-navigation-drawer__scrim",ee.backgroundColorClasses.value],style:[re.value,ee.backgroundColorStyles.value],onClick:()=>{d.value||(S.value=!1)}},P),null)]})])}),{isStuck:W}}}),fn=["color","file","time","date","datetime-local","week","month"],gn=J({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...At(),...zt()},"VTextField"),hn=oe()({name:"VTextField",directives:{vIntersect:we},inheritAttrs:!1,props:gn(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:a,emit:m,slots:t}=i;const s=fe(e,"modelValue"),{isFocused:o,focus:y,blur:f}=Rt(e),{onIntersect:u}=Ht(e),g=T(()=>typeof e.counterValue=="function"?e.counterValue(s.value):typeof e.counterValue=="number"?e.counterValue:(s.value??"").toString().length),c=T(()=>{if(a.maxlength)return a.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),v=T(()=>["plain","underlined"].includes(e.variant)),b=R(),V=R(),S=R(),D=T(()=>fn.includes(e.type)||e.persistentPlaceholder||o.value||e.active);function P(){o.value||y(),$(()=>{S.value!==document.activeElement&&$(()=>{var n;return(n=S.value)==null?void 0:n.focus()})})}function x(n){m("mousedown:control",n),n.target!==S.value&&(P(),n.preventDefault())}function w(n){m("click:control",n)}function _(n,l){n.stopPropagation(),P(),$(()=>{s.value=null,l(),it(e["onClick:clear"],n)})}function B(n){var d;const l=n.target;if(s.value=l.value,(d=e.modelModifiers)!=null&&d.trim&&["text","search","password","tel","url"].includes(e.type)){const r=[l.selectionStart,l.selectionEnd];$(()=>{l.selectionStart=r[0],l.selectionEnd=r[1]})}}return Q(()=>{const n=!!(t.counter||e.counter!==!1&&e.counter!=null),l=!!(n||t.details),[d,r]=at(a),{modelValue:C,...I}=Se.filterProps(e),p=ke.filterProps(e);return k(Se,Z({ref:b,modelValue:s.value,"onUpdate:modelValue":N=>s.value=N,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-input--plain-underlined":v.value},e.class],style:e.style},d,I,{centerAffix:!v.value,focused:o.value}),{...t,default:N=>{let{id:F,isDisabled:K,isDirty:W,isReadonly:se,isValid:ee,reset:re}=N;return k(ke,Z({ref:V,onMousedown:x,onClick:w,"onClick:clear":M=>_(M,re),"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:e.role},p,{id:F.value,active:D.value||W.value,dirty:W.value||e.dirty,disabled:K.value,focused:o.value,error:ee.value===!1}),{...t,default:M=>{let{props:{class:q,...te}}=M;const X=lt(h("input",Z({ref:S,value:s.value,onInput:B,autofocus:e.autofocus,readonly:se.value,disabled:K.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:P,onBlur:f},te,r),null),[[we,{handler:u},null,{once:!0}]]);return h(G,null,[e.prefix&&h("span",{class:"v-text-field__prefix"},[h("span",{class:"v-text-field__prefix__text"},[e.prefix])]),t.default?h("div",{class:j(q),"data-no-activator":""},[t.default(),X]):ot(X,{class:q}),e.suffix&&h("span",{class:"v-text-field__suffix"},[h("span",{class:"v-text-field__suffix__text"},[e.suffix])])])}})},details:l?N=>{var F;return h(G,null,[(F=t.details)==null?void 0:F.call(t,N),n&&h(G,null,[h("span",null,null),k($t,{active:e.persistentCounter||o.value,value:g.value,max:c.value,disabled:e.disabled},t.counter)])])}:void 0})}),Ft({},b,V,S)}}),yn={key:0,class:"message-box"},bn={class:"bottom-btn mx-1"},wn={class:"bottom-btn mx-1"},Tn=me({__name:"ChatMessages",props:{channel_id:{},channel_type:{}},setup(e){const i=st(),{messages:a}=be(i),{getMessagesPage:m,cleanMessage:t}=i,s=rt(),{uid:o}=be(s),{getNameAndPic:y}=s,f=R(!1),u=ut({message:null,messageType:1e3}),g=R(null),c=R(!1),v=R(0),b=T(()=>window.innerHeight-126-ft()),V=ht(async(x,w)=>{const{nickName:_,pic:B}=y(),n=new Dt;n.setUserContent(_,B,x,o.value),pt(n,w,e.channel_id,Number(e.channel_type)),u.message=null,f.value=!1,P()},500),S=x=>{const{message:w,messageType:_}=x;w!==null&&V(w,_)},D=async({done:x})=>{c.value&&(c.value=await m(e.channel_id,Number(e.channel_type),v.value),v.value++),c.value?x("ok"):x("empty")},P=()=>{$(()=>{setTimeout(()=>{var x;gt(2,(x=g.value)==null?void 0:x.$el)},500)})};return ie(async()=>{c.value=await m(e.channel_id,Number(e.channel_type),v.value),v.value++,P()}),ct(()=>{t()}),(x,w)=>ue(a).length>0?(E(),Y("div",yn,[k(en,{ref_key:"messagesContainer",ref:g,class:"v-container",height:b.value,side:"start",onLoad:D},{loading:A(()=>[c.value?(E(),L(de,{key:0,indeterminate:"",size:"16",width:"2"})):ae("",!0)]),empty:A(()=>w[4]||(w[4]=[h("h6",null,"no more",-1)])),default:A(()=>[(E(!0),Y(G,null,dt(ue(a),(_,B)=>(E(),L(Xt,{key:B+"-"+_.messageSeq,message:_.payload,myself:ue(o)!==_.fromUid},null,8,["message","myself"]))),128))]),_:1},8,["height","onLoad"]),k(Qt,{elevation:0,class:"pa-2"},{default:A(()=>[h("div",bn,[k(le,{icon:"mdi-plus",onClick:w[0]||(w[0]=_=>f.value=!f.value),size:"x-large"})]),k(hn,{modelValue:u.message,"onUpdate:modelValue":w[1]||(w[1]=_=>u.message=_),clearable:"",variant:"outlined",density:"compact",rounded:"xl"},null,8,["modelValue"]),h("div",wn,[k(le,{icon:"mdi-navigation-variant",onClick:w[2]||(w[2]=_=>S(u)),size:"x-large"})])]),_:1}),k(mn,{modelValue:f.value,"onUpdate:modelValue":w[3]||(w[3]=_=>f.value=_),location:"bottom",elevation:"0",width:"80"},{default:A(()=>[k(jt,{onRulesSend:S})]),_:1},8,["modelValue"])])):ae("",!0)}});export{Tn as default};
