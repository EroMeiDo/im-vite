import{au as D,av as _,aw as W,s as X,o as Z,t as $,Z as K}from"./index-BN2Uu5Tc.js";var j={exports:{}},Q=j.exports,N;function V(){return N||(N=1,function(f,u){(function(w,d){f.exports=d()})(Q,function(){return function(w){var d={};function a(r){if(d[r])return d[r].exports;var l=d[r]={i:r,l:!1,exports:{}};return w[r].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=w,a.c=d,a.d=function(r,l,y){a.o(r,l)||Object.defineProperty(r,l,{enumerable:!0,get:y})},a.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},a.t=function(r,l){if(1&l&&(r=a(r)),8&l||4&l&&typeof r=="object"&&r&&r.__esModule)return r;var y=Object.create(null);if(a.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:r}),2&l&&typeof r!="string")for(var v in r)a.d(y,v,(function(P){return r[P]}).bind(null,v));return y},a.n=function(r){var l=r&&r.__esModule?function(){return r.default}:function(){return r};return a.d(l,"a",l),l},a.o=function(r,l){return Object.prototype.hasOwnProperty.call(r,l)},a.p="",a(a.s=0)}([function(w,d,a){var r;function l(n){return["image/png","image/jpeg","image/gif"].some(o=>o===n)}a.r(d),a.d(d,"canvastoDataURL",function(){return v}),a.d(d,"canvastoFile",function(){return P}),a.d(d,"dataURLtoFile",function(){return O}),a.d(d,"dataURLtoImage",function(){return M}),a.d(d,"downloadFile",function(){return L}),a.d(d,"filetoDataURL",function(){return B}),a.d(d,"imagetoCanvas",function(){return E}),a.d(d,"urltoBlob",function(){return T}),a.d(d,"urltoImage",function(){return F}),a.d(d,"compress",function(){return q}),a.d(d,"compressAccurately",function(){return J}),a.d(d,"EImageType",function(){return r}),function(n){n.PNG="image/png",n.JPEG="image/jpeg",n.GIF="image/gif"}(r||(r={}));var y=function(n,o,t,e){return new(t||(t=Promise))(function(s,h){function p(c){try{m(e.next(c))}catch(i){h(i)}}function g(c){try{m(e.throw(c))}catch(i){h(i)}}function m(c){var i;c.done?s(c.value):(i=c.value,i instanceof t?i:new t(function(b){b(i)})).then(p,g)}m((e=e.apply(n,[])).next())})};function v(n,o=.92,t=r.JPEG){return y(this,void 0,void 0,function*(){return l(t)||(t=r.JPEG),n.toDataURL(t,o)})}function P(n,o=.92,t=r.JPEG){return new Promise(e=>n.toBlob(s=>e(s),t,o))}var x=function(n,o,t,e){return new(t||(t=Promise))(function(s,h){function p(c){try{m(e.next(c))}catch(i){h(i)}}function g(c){try{m(e.throw(c))}catch(i){h(i)}}function m(c){var i;c.done?s(c.value):(i=c.value,i instanceof t?i:new t(function(b){b(i)})).then(p,g)}m((e=e.apply(n,[])).next())})};function O(n,o){return x(this,void 0,void 0,function*(){const t=n.split(",");let e=t[0].match(/:(.*?);/)[1];const s=atob(t[1]);let h=s.length;const p=new Uint8Array(h);for(;h--;)p[h]=s.charCodeAt(h);return l(o)&&(e=o),new Blob([p],{type:e})})}function M(n){return new Promise((o,t)=>{const e=new Image;e.onload=()=>o(e),e.onerror=()=>t(new Error("dataURLtoImage(): dataURL is illegal")),e.src=n})}function L(n,o){const t=document.createElement("a");t.href=window.URL.createObjectURL(n),t.download=o||Date.now().toString(36),document.body.appendChild(t);const e=document.createEvent("MouseEvents");e.initEvent("click",!1,!1),t.dispatchEvent(e),document.body.removeChild(t)}function B(n){return new Promise(o=>{const t=new FileReader;t.onloadend=e=>o(e.target.result),t.readAsDataURL(n)})}var k=function(n,o,t,e){return new(t||(t=Promise))(function(s,h){function p(c){try{m(e.next(c))}catch(i){h(i)}}function g(c){try{m(e.throw(c))}catch(i){h(i)}}function m(c){var i;c.done?s(c.value):(i=c.value,i instanceof t?i:new t(function(b){b(i)})).then(p,g)}m((e=e.apply(n,[])).next())})};function E(n,o={}){return k(this,void 0,void 0,function*(){const t=Object.assign({},o),e=document.createElement("canvas"),s=e.getContext("2d");let h,p;for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&(t[g]=Number(t[g]));if(t.scale){const g=t.scale>0&&t.scale<10?t.scale:1;p=n.width*g,h=n.height*g}else p=t.width||t.height*n.width/n.height||n.width,h=t.height||t.width*n.height/n.width||n.height;switch([5,6,7,8].some(g=>g===t.orientation)?(e.height=p,e.width=h):(e.height=h,e.width=p),t.orientation){case 3:s.rotate(180*Math.PI/180),s.drawImage(n,-e.width,-e.height,e.width,e.height);break;case 6:s.rotate(90*Math.PI/180),s.drawImage(n,0,-e.width,e.height,e.width);break;case 8:s.rotate(270*Math.PI/180),s.drawImage(n,-e.height,0,e.height,e.width);break;case 2:s.translate(e.width,0),s.scale(-1,1),s.drawImage(n,0,0,e.width,e.height);break;case 4:s.translate(e.width,0),s.scale(-1,1),s.rotate(180*Math.PI/180),s.drawImage(n,-e.width,-e.height,e.width,e.height);break;case 5:s.translate(e.width,0),s.scale(-1,1),s.rotate(90*Math.PI/180),s.drawImage(n,0,-e.width,e.height,e.width);break;case 7:s.translate(e.width,0),s.scale(-1,1),s.rotate(270*Math.PI/180),s.drawImage(n,-e.height,0,e.height,e.width);break;default:s.drawImage(n,0,0,e.width,e.height)}return e})}function T(n){return fetch(n).then(o=>o.blob())}function F(n){return new Promise((o,t)=>{const e=new Image;e.onload=()=>o(e),e.onerror=()=>t(new Error("urltoImage(): Image failed to load, please check the image URL")),e.src=n})}var R=function(n,o,t,e){return new(t||(t=Promise))(function(s,h){function p(c){try{m(e.next(c))}catch(i){h(i)}}function g(c){try{m(e.throw(c))}catch(i){h(i)}}function m(c){var i;c.done?s(c.value):(i=c.value,i instanceof t?i:new t(function(b){b(i)})).then(p,g)}m((e=e.apply(n,[])).next())})};function q(n,o={}){return R(this,void 0,void 0,function*(){if(!(n instanceof Blob))throw new Error("compress(): First arg must be a Blob object or a File object.");if(typeof o!="object"&&(o=Object.assign({quality:o})),o.quality=Number(o.quality),Number.isNaN(o.quality))return n;const t=yield B(n);let e=t.split(",")[0].match(/:(.*?);/)[1],s=r.JPEG;l(o.type)&&(s=o.type,e=o.type);const h=yield M(t),p=yield E(h,Object.assign({},o)),g=yield v(p,o.quality,s),m=yield O(g,e);return m.size>n.size?n:m})}function J(n,o={}){return R(this,void 0,void 0,function*(){if(!(n instanceof Blob))throw new Error("compressAccurately(): First arg must be a Blob object or a File object.");if(typeof o!="object"&&(o=Object.assign({size:o})),o.size=Number(o.size),Number.isNaN(o.size)||1024*o.size>n.size)return n;o.accuracy=Number(o.accuracy),(!o.accuracy||o.accuracy<.8||o.accuracy>.99)&&(o.accuracy=.95);const t=o.size*(2-o.accuracy)*1024,e=1024*o.size,s=o.size*o.accuracy*1024,h=yield B(n);let p=h.split(",")[0].match(/:(.*?);/)[1],g=r.JPEG;l(o.type)&&(g=o.type,p=o.type);const m=yield M(h),c=yield E(m,Object.assign({},o));let i,b=.5;const A=[null,null];for(let I=1;I<=7;I++){i=yield v(c,b,g);const S=.75*i.length;if(I===7){(t<S||s>S)&&(i=[i,...A].filter(C=>C).sort((C,G)=>Math.abs(.75*C.length-e)-Math.abs(.75*G.length-e))[0]);break}if(t<S)A[1]=i,b-=Math.pow(.5,I+1);else{if(!(s>S))break;A[0]=i,b+=Math.pow(.5,I+1)}}const H=yield O(i,p);return H.size>n.size?n:H})}}])})}(j)),j.exports}var U,z;function Y(){return z||(z=1,U=V()),U}var ee=Y();const re=f=>{try{const u=atob(f),w=decodeURIComponent(Array.prototype.map.call(new Uint8Array(u.split("").map(a=>a.charCodeAt(0))),a=>"%"+("00"+a.toString(16)).slice(-2)).join("")),d=JSON.parse(w);return typeof d=="object"&&d!==null?d:{}}catch(u){return console.error("Base64 JSON解析失败:",u),{}}},te=(f,u=300)=>{let w=null;return function(...d){w&&clearTimeout(w);const a=!w;w=setTimeout(()=>{w=null},u),a&&f.apply(this,d)}},ie=()=>{const f=navigator.userAgent,u=f.indexOf("Android")>-1||f.indexOf("Linux")>-1,w=!!f.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return u?"android":w?"ios":"other"},ne=f=>new Promise(u=>{ee.compressAccurately(f,100).then(w=>{u(w)})}),ae=async f=>{const u=await ne(f),{data:{fileId:w,oriFileName:d,filePath:a,preSignUrl:r}}=await D(f.name,!0);await _(u,r,f.type);const{success:l}=await W([{fileId:w,filePath:a,fileSize:u.size}]);return l?"https://media.subtrek.top/subtrek/"+a:null},se=te((f,u)=>{u&&(f===1?u.scrollTo({top:u.scrollHeight,behavior:"smooth"}):u.scrollTop=u.scrollHeight)},500),ce=()=>{var a,r;if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return 0;const u=document.createElement("div");u.style.position="fixed",u.style.top="0",u.style.left="0",u.style.width="0",u.style.height="0",u.style.paddingTop="constant(safe-area-inset-top)",u.style.paddingTop="env(safe-area-inset-top)",document.body.appendChild(u);const w=getComputedStyle(u),d=parseFloat(w.paddingTop);if(document.body.removeChild(u),d&&d>0)return d;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){const l=window.innerWidth>window.innerHeight,y=Math.min(window.screen.height,window.screen.width),v=Math.max(window.screen.height,window.screen.width),x=(l?v:y)-window.innerHeight;return x>0?x:20}if(window.Android)return((r=(a=window.Android).getStatusBarHeight)==null?void 0:r.call(a))||0;{const y=window.innerWidth>window.innerHeight?screen.width:screen.height,v=window.innerHeight,P=y-v;return P>0?P:0}};function ue(){const f=X(!1);return Z(()=>{window.requestAnimationFrame(()=>{f.value=!0})}),{ssrBootStyles:$(()=>f.value?void 0:{transition:"none !important"}),isBooted:K(f)}}export{ie as a,te as d,ce as g,ae as i,re as p,se as s,ue as u};
